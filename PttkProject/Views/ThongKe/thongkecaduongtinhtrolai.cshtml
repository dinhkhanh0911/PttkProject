
@{
    ViewBag.Title = "thongkecaduongtinhtrolai";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<!--Chart-->
<div class="container-content">
    <h1>
        THỐNG KÊ CA DƯƠNG TÍNH TRỞ LẠI
    </h1>

    <div class="container-fluid">
        <div class="card">

            <div class="row">
                <div class="col-sm-8">
                    <canvas id="myChart" width="100%"></canvas>
                </div>
                <div class="col-sm-4">
                    @using (Html.BeginForm("thongKeCaDuongTinhTroLai", "ThongKe", FormMethod.Post))
                    {                       
                        <button class="btn btn-outline-success">Hiển thị</button>
                    }
                </div>
            </div>

        </div>
    </div>
    <!-- /.chat-->
    <!--Datatable-->
    <div class="container-fluid">
        <table id="datatable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Họ tên</th>
                    <th>Số CMND</th>
                    <th>Số điện thoại</th>
                    <th>Giới tính</th>
                </tr>
            </thead>
            <tbody id="tbody_thongke">
                <tr>
                    <td>STT</td>
                    <td>STT</td>
                    <td>STT</td>
                    <td>STT</td>
                    <td>STT</td>
                </tr>
            </tbody>
            <tfoot>

            </tfoot>
        </table>
    </div>
</div>
<script>
    $(document).ready(function () {
        $('#datatable').DataTable({
            "language": {
                "search": "Tìm kiếm",
                "lengthMenu": "Hiển thị _MENU_ bản ghi trên 1 trang",
                "zeroRecords": "Không tìm thấy dữ liệu",
                "info": "Hiển thị _PAGE_ trên _PAGES_",
                "infoEmpty": "Không có dữ liệu tương ứng",
                "infoFiltered": "(Tìm từ _MAX_ bản ghi)",
                "paginate": {
                    "first": "Đầu",
                    "last": "Cuối",
                    "next": "Sau",
                    "previous": "Trước"
                },
            }            
        });

    });
    $('form').submit(function (event) {
        $.ajax({
            method: $(this).attr('method'),
            url: $(this).attr('action'),
            data: $(this).serialize(),
            type: 'POST',
            error: function (xhr, ajaxOptions, thrownError) {
                console.log(xhr);
                console.log(ajaxOptions);
                console.log(thrownError);
            },

        }).done(function (response) {
            if (response.code == 200) {
                console.log(response.data);
                let data1 = response.data.map(obj => Object.values(obj));
                $("#datatable").DataTable().clear();
                $("#datatable").DataTable().rows.add(data1);
                $("#datatable").DataTable().draw();

            }
            else {
            }
        });
        event.preventDefault();
    });
</script>
<script>
    //đồ thị
    $(document).ready(function () {
        const labels = [
            'Tháng 1',
            'Tháng 2',
            'Tháng 3',
            'Tháng 4',
            'Tháng 5',
            'Tháng 6',
        ];
        const data = {
            labels: labels,
            datasets: [{
                label: 'My First dataset',
                backgroundColor: '#17a2b8',
                borderColor: 'rgb(255, 99, 132)',
                data: [29128, 15812, 4939, 30905, 16612, 52459, 37734],
            }]
        };
        const config = {
            type: 'bar',
            data: data,
            options: {},

        };
        const myChart = new Chart(
            document.getElementById('myChart'),
            config
        );
    });

</script>